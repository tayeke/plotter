// Generated by CoffeeScript 1.4.0
(function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(){this.dataSuccess=n(this.dataSuccess,this);this.dataError=n(this.dataError,this);this.storeShows=n(this.storeShows,this);this.insertShow=n(this.insertShow,this);this.removeShow=n(this.removeShow,this);this.addShow=n(this.addShow,this);this.getAllShows=n(this.getAllShows,this);this.receivedEvent=n(this.receivedEvent,this);this.domReady=n(this.domReady,this);this.onDeviceReady=n(this.onDeviceReady,this);this.bindEvents=n(this.bindEvents,this);this.shows=[];this.browser_testing=!1}e.prototype.bindEvents=function(){var e=this;this.receivedEvent("body loaded");return $(function(){return e.browser_testing?e.onDeviceReady():document.addEventListener("deviceready",e.onDeviceReady,!1)})};e.prototype.onDeviceReady=function(){this.receivedEvent("deviceready");this.database=window.localStorage;this.receivedEvent("localstorage ready");this.getAllShows();return this.domReady()};e.prototype.domReady=function(){var e=this;this.receivedEvent("adding jquery functionality in domReady");return $("#newShow").submit(function(t){var n;t.preventDefault();n=$('input[name="show_title"]');e.insertShow(n.val());return n.val("")})};e.prototype.receivedEvent=function(e){return console.log("Received Event: "+e)};e.prototype.getAllShows=function(){var e,t,n,r,i,s;t=this.database.getItem("shows");if(t){e=JSON.parse(t);s=[];for(r=0,i=e.length;r<i;r++){n=e[r];s.push(this.addShow(n))}return s}return this.shows=[]};e.prototype.addShow=function(e){return this.shows.push(new t(e))};e.prototype.removeShow=function(e){var t;t=this.shows.indexOf(e);this.shows.splice(t,1);return this.storeShows()};e.prototype.insertShow=function(e){var n;this.receivedEvent("Created: "+e);n={title:e,season:1,episode:1};this.shows.push(new t(n));return this.storeShows()};e.prototype.storeShows=function(){var e,t,n,r,i;e=[];i=this.shows;for(n=0,r=i.length;n<r;n++){t=i[n];e.push(t.attributes)}return this.database.setItem("shows",JSON.stringify(e))};e.prototype.dataError=function(e){return alert("Sorry there was an error processing data: "+e.code+" : "+e.msg)};e.prototype.dataSuccess=function(){};return e}();t=function(){function e(e){this.remove=n(this.remove,this);this.createElement=n(this.createElement,this);this.render=n(this.render,this);this.decrement=n(this.decrement,this);this.increment=n(this.increment,this);this.bindEvents=n(this.bindEvents,this);var t,r;this.attributes={};for(t in e){r=e[t];this.attributes[t]=r}this.createElement();this.bindEvents();this.render()}e.prototype.bindEvents=function(){var e=this;return this.$el.click(function(t){e.remove();return app.removeShow(e)})};e.prototype.increment=function(e){this.attributes[e]+=1;return app.storeShows()};e.prototype.decrement=function(e){this.attributes[e]-=1;return app.storeShows()};e.prototype.render=function(){this.$el.html('<a href="#">'+this.attributes.title+'<span class="chevron"></span></a>');return $("#shows").append(this.$el)};e.prototype.createElement=function(){return this.$el=$("<li>")};e.prototype.remove=function(){return this.$el.remove()};return e}();this.app=new e}).call(this);